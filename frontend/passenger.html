<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HPK GO - ฤแบทt xe</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/src/styles/passenger.css" />
</head>
<body>
  <div class="top-bar">
    <span class="logo">๐ HPK GO</span>
    <span class="user-info" id="userInfo">Chฦฐa ฤฤng nhแบญp</span>
    <button class="btn-logout" id="btnLogout" onclick="window.__app.logout()" style="display:none">ฤฤng xuแบฅt</button>
  </div>

  <!-- AUTH SCREEN -->
  <div id="authScreen" class="auth-screen">
    <div class="auth-card">
      <h2 style="text-align:center;color:#00b14f;margin-bottom:20px">๐ HPK GO</h2>
      
      <div id="auth-login">
        <h3 style="margin-bottom:12px">ฤฤng nhแบญp Khรกch hรng</h3>
        <div class="auth-field">
          <label>Email</label>
          <input type="email" id="loginEmail" placeholder="email@example.com">
        </div>
        <div class="auth-field">
          <label>Mแบญt khแบฉu</label>
          <input type="password" id="loginPassword" placeholder="โขโขโขโขโขโข">
        </div>
        <div id="loginError" class="auth-error"></div>
        <button class="btn btn-primary" onclick="window.__app.login()">ฤฤng nhแบญp</button>
        <p class="auth-switch">Chฦฐa cรณ tรi khoแบฃn? <a href="#" onclick="window.__app.showRegister()">ฤฤng kรฝ</a></p>
        <p class="auth-switch"><a href="/driver.html">Tรดi lร tรi xแบฟ โ</a></p>
      </div>

      <div id="auth-register" style="display:none">
        <h3 style="margin-bottom:12px">ฤฤng kรฝ Khรกch hรng</h3>
        <div class="auth-field">
          <label>Hแป tรชn</label>
          <input type="text" id="regName" placeholder="Nguyแปn Vฤn A">
        </div>
        <div class="auth-field">
          <label>Email</label>
          <input type="email" id="regEmail" placeholder="email@example.com">
        </div>
        <div class="auth-field">
          <label>Mแบญt khแบฉu</label>
          <input type="password" id="regPassword" placeholder="Tแปi thiแปu 6 kรฝ tแปฑ">
        </div>
        <div id="regError" class="auth-error"></div>
        <button class="btn btn-primary" onclick="window.__app.register()">ฤฤng kรฝ</button>
        <p class="auth-switch">ฤรฃ cรณ tรi khoแบฃn? <a href="#" onclick="window.__app.showLogin()">ฤฤng nhแบญp</a></p>
      </div>
    </div>
  </div>

  <!-- MAP SCREEN (hidden until logged in) -->
  <div id="mapScreen" style="display:none">
    <div id="map"></div>

    <button class="btn-gps" onclick="window.__app.getMyLocation()" title="Vแป trรญ cแปงa tรดi">๐</button>

    <div class="panel" id="panel">
      <div class="panel-handle"></div>

      <!-- Step 1: Input pickup / dropoff -->
      <div id="step-input" style="display:block">
        <div class="panel-header">
          <span class="logo">Bแบกn muแปn ฤi ฤรขu?</span>
        </div>

        <div class="input-group">
          <label>๐ ฤiแปm ฤรณn</label>
          <div class="input-row">
            <input type="text" id="pickupLat" placeholder="Lat" readonly>
            <input type="text" id="pickupLng" placeholder="Lng" readonly>
          </div>
          <p class="hint">Nhแบฅn vรo bแบฃn ฤแป hoแบทc dรนng GPS ฤแป chแปn ฤiแปm ฤรณn</p>
        </div>

        <div class="input-group">
          <label>๐ ฤiแปm ฤแบฟn</label>
          <div class="input-row">
            <input type="text" id="dropoffLat" placeholder="Lat" readonly>
            <input type="text" id="dropoffLng" placeholder="Lng" readonly>
          </div>
          <p class="hint">Nhแบฅn vรo bแบฃn ฤแป ฤแป chแปn ฤiแปm ฤแบฟn</p>
        </div>

        <div id="routeInfo" style="display:none" class="trip-info">
          <div class="row">
            <span class="label">Khoแบฃng cรกch</span>
            <span class="value" id="distanceText">--</span>
          </div>
          <div class="row">
            <span class="label">Thแปi gian ฦฐแปc tรญnh</span>
            <span class="value" id="durationText">--</span>
          </div>
          <div class="row">
            <span class="label">Giรก ฦฐแปc tรญnh</span>
            <span class="value" id="priceText" style="color:#00b14f;font-size:18px">--</span>
          </div>
        </div>

        <button class="btn btn-primary" id="btnBook" onclick="window.__app.requestTrip()" disabled>ฤแบทt xe ngay</button>
        <button class="btn btn-secondary" onclick="window.__app.resetSelection()">Chแปn lแบกi</button>
      </div>

      <!-- Step 2: Searching for driver -->
      <div id="step-searching" style="display:none">
        <div style="text-align:center;padding:20px">
          <div class="searching-anim" style="font-size:48px">๐</div>
          <h3 style="margin-top:12px">ฤang tรฌm tรi xแบฟ...</h3>
          <p style="color:#888;font-size:13px;margin-top:8px" id="searchingText">ฤang tรฌm tรi xแบฟ gแบงn bแบกn</p>
          <button class="btn btn-danger" onclick="window.__app.cancelTrip()" style="margin-top:16px">Hแปงy ฤแบทt xe</button>
        </div>
      </div>

      <!-- Step 3: Driver accepted -->
      <div id="step-tracking" style="display:none">
        <div id="driverCard" class="driver-card">
          <div class="name" id="driverName">--</div>
          <div class="detail" id="driverPlate">๐ --</div>
          <div class="detail" id="driverVehicle">๐๏ธ --</div>
        </div>
        <div class="trip-info">
          <div class="row">
            <span class="label">Trแบกng thรกi</span>
            <span id="tripStatusBadge" class="status-badge status-accepted">Tรi xแบฟ ฤang ฤแบฟn</span>
          </div>
          <div class="row">
            <span class="label">Khoแบฃng cรกch</span>
            <span class="value" id="trackDistance">--</span>
          </div>
          <div class="row">
            <span class="label">Giรก</span>
            <span class="value" id="trackPrice" style="color:#00b14f">--</span>
          </div>
        </div>
        <button class="btn btn-danger" id="btnCancelTracking" onclick="window.__app.cancelTrip()">Hแปงy chuyแบฟn</button>
      </div>

      <!-- Step 4: Trip finished -->
      <div id="step-finished" style="display:none">
        <div style="text-align:center;padding:20px">
          <div style="font-size:48px">โ</div>
          <h3 style="margin-top:12px;color:#00b14f">Hoรn thรnh chuyแบฟn ฤi!</h3>
          <p style="color:#888;font-size:13px;margin-top:8px">Cแบฃm ฦกn bแบกn ฤรฃ sแปญ dแปฅng HPK GO</p>
          <div class="trip-info" style="margin-top:16px">
            <div class="row">
              <span class="label">Tแปng tiแปn</span>
              <span class="value" id="finalPrice" style="color:#00b14f;font-size:20px">--</span>
            </div>
          </div>
          <button class="btn btn-primary" onclick="window.__app.resetAll()" style="margin-top:12px">ฤแบทt xe mแปi</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script type="module" src="/src/passenger.js"></script>
</body>
</html>
