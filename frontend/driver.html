<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HPK GO - Tรi xแบฟ</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/src/styles/driver.css" />
</head>
<body>
  <div class="top-bar">
    <span class="logo">๐ HPK GO Driver</span>
    <span class="driver-name" id="driverNameTop">Chฦฐa ฤฤng nhแบญp</span>
    <button class="btn-logout" id="btnLogout" onclick="window.__app.logout()" style="display:none">ฤฤng xuแบฅt</button>
  </div>

  <!-- AUTH SCREEN -->
  <div id="authScreen" class="auth-screen">
    <div class="auth-card">
      <h2 style="text-align:center;color:#ff6600;margin-bottom:20px">๐ HPK GO Driver</h2>

      <div id="auth-login">
        <h3 style="margin-bottom:12px">ฤฤng nhแบญp Tรi xแบฟ</h3>
        <div class="auth-field">
          <label>Email</label>
          <input type="email" id="loginEmail" placeholder="email@example.com">
        </div>
        <div class="auth-field">
          <label>Mแบญt khแบฉu</label>
          <input type="password" id="loginPassword" placeholder="โขโขโขโขโขโข">
        </div>
        <div id="loginError" class="auth-error"></div>
        <button class="btn btn-online" onclick="window.__app.login()">ฤฤng nhแบญp</button>
        <p class="auth-switch">Chฦฐa cรณ tรi khoแบฃn? <a href="#" onclick="window.__app.showRegister()">ฤฤng kรฝ</a></p>
        <p class="auth-switch"><a href="/passenger.html">Tรดi lร khรกch hรng โ</a></p>
      </div>

      <div id="auth-register" style="display:none">
        <h3 style="margin-bottom:12px">ฤฤng kรฝ Tรi xแบฟ</h3>
        <div class="auth-field">
          <label>Hแป tรชn</label>
          <input type="text" id="regName" placeholder="Nguyแปn Vฤn A">
        </div>
        <div class="auth-field">
          <label>Email</label>
          <input type="email" id="regEmail" placeholder="email@example.com">
        </div>
        <div class="auth-field">
          <label>Mแบญt khแบฉu</label>
          <input type="password" id="regPassword" placeholder="Tแปi thiแปu 6 kรฝ tแปฑ">
        </div>
        <div class="auth-field">
          <label>Loแบกi xe</label>
          <select id="regVehicleType" class="driver-select">
            <option value="car">ร tรด</option>
            <option value="motorbike">Xe mรกy</option>
          </select>
        </div>
        <div class="auth-field">
          <label>Biแปn sแป xe</label>
          <input type="text" id="regPlateNumber" placeholder="59A-12345">
        </div>
        <div id="regError" class="auth-error"></div>
        <button class="btn btn-online" onclick="window.__app.register()">ฤฤng kรฝ</button>
        <p class="auth-switch">ฤรฃ cรณ tรi khoแบฃn? <a href="#" onclick="window.__app.showLogin()">ฤฤng nhแบญp</a></p>
      </div>
    </div>
  </div>

  <!-- MAP SCREEN (hidden until logged in) -->
  <div id="mapScreen" style="display:none">
    <div id="map"></div>

    <div class="panel" id="panel">
      <div class="panel-handle"></div>

      <!-- Step 0: placeholder for showStep compatibility -->
      <div id="step-select" style="display:none"></div>

      <!-- Step 1: Online/Offline toggle -->
      <div id="step-dashboard" style="display:block">
        <div class="status-indicator">
          <div class="status-dot" id="statusDot"></div>
          <span id="statusText">Offline</span>
        </div>

        <div class="location-sim">
          ๐ก <strong>Mรด phแปng vแป trรญ:</strong> Nhแบฅn vรo bแบฃn ฤแป ฤแป ฤแบทt vแป trรญ cแปงa bแบกn, hoแบทc dรนng GPS thแปฑc.
        </div>

        <button class="btn" id="btnToggle" onclick="window.__app.toggleOnline()">Bแบฏt ฤแบงu nhแบญn chuyแบฟn</button>
      </div>

      <!-- Step 2: Trip request popup -->
      <div id="step-request" style="display:none">
        <div class="trip-request-card pulse-anim">
          <h3>๐ Chuyแบฟn mแปi!</h3>
          <div class="detail" id="reqPickup">๐ ฤรณn: --</div>
          <div class="detail" id="reqDropoff">๐ ฤแบฟn: --</div>
          <div class="detail" id="reqDistance">๐ --</div>
          <div class="price" id="reqPrice">--</div>
        </div>
        <div class="countdown" id="countdown">15</div>
        <div class="btn-row">
          <button class="btn btn-accept" onclick="window.__app.acceptTrip()">โ Nhแบญn chuyแบฟn</button>
          <button class="btn btn-reject" onclick="window.__app.rejectTrip()">โ Tแปซ chแปi</button>
        </div>
      </div>

      <!-- Step 3: Active trip -->
      <div id="step-trip" style="display:none">
        <div class="trip-info-card">
          <div class="row">
            <span class="label">Trแบกng thรกi</span>
            <span class="value" id="tripStatus">--</span>
          </div>
          <div class="row">
            <span class="label">ฤiแปm ฤรณn</span>
            <span class="value" id="tripPickup">--</span>
          </div>
          <div class="row">
            <span class="label">ฤiแปm ฤแบฟn</span>
            <span class="value" id="tripDropoff">--</span>
          </div>
          <div class="row">
            <span class="label">Giรก</span>
            <span class="value" id="tripPrice" style="color:#ff6600;font-size:18px">--</span>
          </div>
        </div>

        <button class="btn btn-action" id="btnTripAction" onclick="window.__app.tripAction()">--</button>
      </div>

      <!-- Step 4: Trip finished -->
      <div id="step-finished" style="display:none">
        <div style="text-align:center;padding:20px">
          <div style="font-size:48px">๐</div>
          <h3 style="margin-top:12px;color:#00b14f">Hoรn thรnh chuyแบฟn!</h3>
          <div class="trip-info-card" style="margin-top:16px">
            <div class="row">
              <span class="label">Thu nhแบญp</span>
              <span class="value" id="earnedAmount" style="color:#00b14f;font-size:20px">--</span>
            </div>
          </div>
          <button class="btn btn-online" onclick="window.__app.backToDashboard()" style="margin-top:12px">Tiแบฟp tแปฅc nhแบญn chuyแบฟn</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script type="module" src="/src/driver.js"></script>
</body>
</html>
